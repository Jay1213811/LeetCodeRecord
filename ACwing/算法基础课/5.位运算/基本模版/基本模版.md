# 位运算

###### 摘自菜鸟教程

### 基本概念

| 运算符 | 描述                                                         | 实例                                   |
| :----- | :----------------------------------------------------------- | :------------------------------------- |
| &      | 按位与运算符"&"是双目运算符。 其功能是参与运算的两数各对应的二进位相与。 | (A & B) 结果为 12, 二进制为 0000 1100  |
| \|     | 按位或运算符"\|"是双目运算符。 其功能是参与运算的两数各对应的二进位相或 | (A \| B) 结果为 61, 二进制为 0011 1101 |
| ^      | 按位异或运算符"^"是双目运算符。 其功能是参与运算的两数各对应的二进位相异或，当两对应的二进位相异时，结果为1。 | (A ^ B) 结果为 49, 二进制为 0011 0001  |
| <<     | 左移运算符"<<"是双目运算符。**左移n位就是乘以2的n次方**。 其功能把"<<"左边的运算数的各二进位全部左移若干位，由"<<"右边的数指定移动的位数，高位丢弃，低位补0。 | A << 2 结果为 240 ，二进制为 1111 0000 |
| >>     | 右移运算符">>"是双目运算符。**右移n位就是除以2的n次方**。 其功能是把">>"左边的运算数的各二进位全部右移若干位，">>"右边的数指定移动的位数。 | A >> 2 结果为 15 ，二进制为 0000 1111  |

### 位运算最常用的两种操作如下

1. **求n的二进制表示中第k位数字**

   ```markdown
   第k位数字=n>>k&1
   ```

   

   ```markdown
    如n=15=(1111)2
   从个位开始算
   第一步:先把第k位数字移动到最后一位 n>>k
   第二步:看个位是几 设个位数为x 最后一个的数即 x&1
   ```

   ```go
   //具体代码展示
   func getN(n int,k int)int{
   	return n>>k&1
   }
   12的二进制为1100
   则
   n=12 k=0 返回0
   n=12 k=1 返回0
   n=12 k=2 返回1
   n=12 k=3 返回1
   ```

   

2. **返回n的最后一位1的位置**

   
   
   ```go
   lowbit(n) = n & -n 
   //如x=1010 返回(10)2=(2)10
   //x=101000 返回(1000)2=(8)10
   ```
   
   **具体实现:**
   
   ```go
   x&-x=x&(-x+1)
   如  x=1010...10000...0
      -x=0101...01111...1
    -x+1=0101...10000...0
   
   那么
   x&-x=x&(-x+1)
   	   =0000...10000...0
   ```
   
   **应用场景**
   
   **统计一个数中1的个数**

## 具体例题:

```markdown
给定一个长度为n的数组,请你求出数组中每个数的二进制表示中1的个数
如输入nums:=[1,2,3,4,5]
输出[1,1,2,1,2]
```

```go
func getOneNum(nums []int)[]int{
	//通过lowbit来实现
	res:=[]int{}
	count:=0
	for i:=0;i<len(nums);i++{
		for nums[i]!=0{
			nums[i]-=lowbit(nums[i])
			count++
		}
		res=append(res,count)
		count=0
	}
	return res
}
func lowbit(x int)int{
	return x&-x
}
```

#   其它技巧

### 资源来源：https://www.zhihu.com/question/38206659

## **常见位运算问题**

### 1. 位操作实现乘除法

- 数 a 向右移一位，相当于将 a 除以 2；数 a 向左移一位，相当于将 a 乘以 2

```text
int a = 2;
a >> 1; ---> 1
a << 1; ---> 4
```

### 2. 位操作交换两数

- 位操作交换两数可以不需要第三个临时变量，虽然普通操作也可以做到，但是没有其效率高

```go
//普通操作
func swqp(a,b int){
  a,b=b,a
}

//位与操作
void swap(a,b int) {
  a^=b
  b^=a
	a^=b
}
```

位与操作解释：

第一步：a ^= b ---> a = (a^b);

第二步：b ^= a ---> b = b^(a^b) ---> b = (b^b)^a = a

第三步：a ^= b ---> a = (a^b)^a = (a^a)^b = b

### 3. 位操作判断

- 只要根据数的最后一位是 0 还是 1 来决定即可，为 0 就是偶数，为 1 就是奇数。

```go
if a&1 ==0{
  //偶数
}
```

### 